// Code generated by winrt-go-gen. DO NOT EDIT.

//go:build windows

//nolint:all
package playback

import (
	"syscall"
	"unsafe"

	"github.com/go-ole/go-ole"
	"github.com/saltosystems/winrt-go/windows/foundation"
)

const SignatureMediaPlaybackTimedMetadataTrackList string = "rc(Windows.Media.Playback.MediaPlaybackTimedMetadataTrackList;{72b41319-bbfb-46a3-9372-9c9c744b9438})"

type MediaPlaybackTimedMetadataTrackList struct {
	ole.IUnknown
}

func (impl *MediaPlaybackTimedMetadataTrackList) AddPresentationModeChanged(handler *foundation.TypedEventHandler) (foundation.EventRegistrationToken, error) {
	itf := impl.MustQueryInterface(ole.NewGUID(GUIDiMediaPlaybackTimedMetadataTrackList))
	defer itf.Release()
	v := (*iMediaPlaybackTimedMetadataTrackList)(unsafe.Pointer(itf))
	return v.AddPresentationModeChanged(handler)
}

func (impl *MediaPlaybackTimedMetadataTrackList) RemovePresentationModeChanged(token foundation.EventRegistrationToken) error {
	itf := impl.MustQueryInterface(ole.NewGUID(GUIDiMediaPlaybackTimedMetadataTrackList))
	defer itf.Release()
	v := (*iMediaPlaybackTimedMetadataTrackList)(unsafe.Pointer(itf))
	return v.RemovePresentationModeChanged(token)
}

func (impl *MediaPlaybackTimedMetadataTrackList) GetPresentationMode(index uint32) (TimedMetadataTrackPresentationMode, error) {
	itf := impl.MustQueryInterface(ole.NewGUID(GUIDiMediaPlaybackTimedMetadataTrackList))
	defer itf.Release()
	v := (*iMediaPlaybackTimedMetadataTrackList)(unsafe.Pointer(itf))
	return v.GetPresentationMode(index)
}

func (impl *MediaPlaybackTimedMetadataTrackList) SetPresentationMode(index uint32, value TimedMetadataTrackPresentationMode) error {
	itf := impl.MustQueryInterface(ole.NewGUID(GUIDiMediaPlaybackTimedMetadataTrackList))
	defer itf.Release()
	v := (*iMediaPlaybackTimedMetadataTrackList)(unsafe.Pointer(itf))
	return v.SetPresentationMode(index, value)
}

const GUIDiMediaPlaybackTimedMetadataTrackList string = "72b41319-bbfb-46a3-9372-9c9c744b9438"
const SignatureiMediaPlaybackTimedMetadataTrackList string = "{72b41319-bbfb-46a3-9372-9c9c744b9438}"

type iMediaPlaybackTimedMetadataTrackList struct {
	ole.IInspectable
}

type iMediaPlaybackTimedMetadataTrackListVtbl struct {
	ole.IInspectableVtbl

	AddPresentationModeChanged    uintptr
	RemovePresentationModeChanged uintptr
	GetPresentationMode           uintptr
	SetPresentationMode           uintptr
}

func (v *iMediaPlaybackTimedMetadataTrackList) VTable() *iMediaPlaybackTimedMetadataTrackListVtbl {
	return (*iMediaPlaybackTimedMetadataTrackListVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *iMediaPlaybackTimedMetadataTrackList) AddPresentationModeChanged(handler *foundation.TypedEventHandler) (foundation.EventRegistrationToken, error) {
	var out foundation.EventRegistrationToken
	hr, _, _ := syscall.SyscallN(
		v.VTable().AddPresentationModeChanged,
		uintptr(unsafe.Pointer(v)),       // this
		uintptr(unsafe.Pointer(handler)), // in foundation.TypedEventHandler
		uintptr(unsafe.Pointer(&out)),    // out foundation.EventRegistrationToken
	)

	if hr != 0 {
		return foundation.EventRegistrationToken{}, ole.NewError(hr)
	}

	return out, nil
}

func (v *iMediaPlaybackTimedMetadataTrackList) RemovePresentationModeChanged(token foundation.EventRegistrationToken) error {
	hr, _, _ := syscall.SyscallN(
		v.VTable().RemovePresentationModeChanged,
		uintptr(unsafe.Pointer(v)),      // this
		uintptr(unsafe.Pointer(&token)), // in foundation.EventRegistrationToken
	)

	if hr != 0 {
		return ole.NewError(hr)
	}

	return nil
}

func (v *iMediaPlaybackTimedMetadataTrackList) GetPresentationMode(index uint32) (TimedMetadataTrackPresentationMode, error) {
	var out TimedMetadataTrackPresentationMode
	hr, _, _ := syscall.SyscallN(
		v.VTable().GetPresentationMode,
		uintptr(unsafe.Pointer(v)),    // this
		uintptr(index),                // in uint32
		uintptr(unsafe.Pointer(&out)), // out TimedMetadataTrackPresentationMode
	)

	if hr != 0 {
		return TimedMetadataTrackPresentationModeDisabled, ole.NewError(hr)
	}

	return out, nil
}

func (v *iMediaPlaybackTimedMetadataTrackList) SetPresentationMode(index uint32, value TimedMetadataTrackPresentationMode) error {
	hr, _, _ := syscall.SyscallN(
		v.VTable().SetPresentationMode,
		uintptr(unsafe.Pointer(v)), // this
		uintptr(index),             // in uint32
		uintptr(value),             // in TimedMetadataTrackPresentationMode
	)

	if hr != 0 {
		return ole.NewError(hr)
	}

	return nil
}
