// Code generated by winrt-go-gen. DO NOT EDIT.

//go:build windows

//nolint:all
package playback

import (
	"syscall"
	"unsafe"

	"github.com/go-ole/go-ole"
)

const SignatureMediaPlaybackSessionOutputDegradationPolicyState string = "rc(Windows.Media.Playback.MediaPlaybackSessionOutputDegradationPolicyState;{558e727d-f633-49f9-965a-abaa1db709be})"

type MediaPlaybackSessionOutputDegradationPolicyState struct {
	ole.IUnknown
}

func (impl *MediaPlaybackSessionOutputDegradationPolicyState) GetVideoConstrictionReason() (MediaPlaybackSessionVideoConstrictionReason, error) {
	itf := impl.MustQueryInterface(ole.NewGUID(GUIDiMediaPlaybackSessionOutputDegradationPolicyState))
	defer itf.Release()
	v := (*iMediaPlaybackSessionOutputDegradationPolicyState)(unsafe.Pointer(itf))
	return v.GetVideoConstrictionReason()
}

const GUIDiMediaPlaybackSessionOutputDegradationPolicyState string = "558e727d-f633-49f9-965a-abaa1db709be"
const SignatureiMediaPlaybackSessionOutputDegradationPolicyState string = "{558e727d-f633-49f9-965a-abaa1db709be}"

type iMediaPlaybackSessionOutputDegradationPolicyState struct {
	ole.IInspectable
}

type iMediaPlaybackSessionOutputDegradationPolicyStateVtbl struct {
	ole.IInspectableVtbl

	GetVideoConstrictionReason uintptr
}

func (v *iMediaPlaybackSessionOutputDegradationPolicyState) VTable() *iMediaPlaybackSessionOutputDegradationPolicyStateVtbl {
	return (*iMediaPlaybackSessionOutputDegradationPolicyStateVtbl)(unsafe.Pointer(v.RawVTable))
}

func (v *iMediaPlaybackSessionOutputDegradationPolicyState) GetVideoConstrictionReason() (MediaPlaybackSessionVideoConstrictionReason, error) {
	var out MediaPlaybackSessionVideoConstrictionReason
	hr, _, _ := syscall.SyscallN(
		v.VTable().GetVideoConstrictionReason,
		uintptr(unsafe.Pointer(v)),    // this
		uintptr(unsafe.Pointer(&out)), // out MediaPlaybackSessionVideoConstrictionReason
	)

	if hr != 0 {
		return MediaPlaybackSessionVideoConstrictionReasonNone, ole.NewError(hr)
	}

	return out, nil
}
